# Kubernetes 面试题（第 1 批 25题）

---

## 一、Kubernetes 基础概念

### Q1：什么是 Kubernetes？核心功能有哪些？

**答案：**
Kubernetes 是开源的容器编排平台，自动化部署、扩展、管理容器化应用。
核心功能：

1. 容器调度与负载均衡
2. 自动扩缩容（HPA/VPA/Cluster Autoscaler）
3. 服务发现与 DNS
4. 自愈能力
5. 滚动更新与回滚
6. 配置管理（ConfigMap）和机密管理（Secret）

### Q2：K8s 与 Docker 的关系？

**答案：**
Docker 提供容器运行环境，K8s 是容器编排工具，可管理 Docker 或其他 runtime 容器在集群中的调度。

### Q3：Pod 是什么？为什么是最小调度单元？

**答案：**
Pod 是 K8s 最小部署单元，包含一个或多个紧密耦合的容器，共享网络和存储。

### Q4：Deployment、StatefulSet、DaemonSet、Job、CronJob 区别？

**答案：**

| 控制器         | 特点                   | 适用场景    |
| ----------- | -------------------- | ------- |
| Deployment  | 无状态应用，可滚动更新          | Web 服务  |
| StatefulSet | 有状态应用，固定 Pod 名称、顺序启动 | 数据库、缓存  |
| DaemonSet   | 每节点一份 Pod            | 日志收集、监控 |
| Job         | 一次性任务                | 批处理     |
| CronJob     | 定时任务                 | 定期任务    |

### Q5：Service 类型及适用场景？

**答案：**

* ClusterIP：集群内部访问
* NodePort：节点 IP + 端口访问
* LoadBalancer：云 LB 对外暴露
* ExternalName：DNS 映射到外部域名

### Q6：K8s 架构组成？

**答案：**
Master 节点：kube-apiserver、etcd、kube-scheduler、kube-controller-manager
Node 节点：kubelet、kube-proxy、Container runtime

### Q7：etcd 的作用及备份方式？

**答案：**
保存集群状态，备份：`etcdctl snapshot save <file>`。生产环境建议多节点集群并定期备份。

---

## 二、Pod 调度与控制器

### Q8：Pod 调度流程？

**答案：**

1. 创建 Pod
2. 写入 etcd
3. Scheduler 选择节点
4. kubelet 拉取镜像启动容器
5. Pod 状态更新到 Running

### Q9：Deployment 如何滚动更新？

**答案：**
通过新 ReplicaSet 替换旧 ReplicaSet，参数：`maxUnavailable`、`maxSurge`；可回滚：`kubectl rollout undo deployment <name>`

### Q10：HPA 原理？

**答案：**
基于 Metrics Server 指标（CPU/内存或自定义指标），动态调整 Pod 副本数。

### Q11：VPA 原理与适用场景？

**答案：**
自动调整 Pod 的 CPU/内存请求，适合有状态服务优化资源，配合 HPA 使用。

### Q12：StatefulSet 有序启动和更新机制？

**答案：**
Pod 按序号启动/更新，适用于数据库、Kafka 等有状态服务。

### Q13：蓝绿发布和灰度发布区别？

**答案：**

* 蓝绿发布：旧版本和新版本同时存在，通过 Service 切换流量
* 灰度发布：新版本占比例流量，可通过 Ingress 或 Service Mesh 控制

### Q14：Pod 调度约束有哪些？

**答案：**
NodeSelector、Node Affinity、Pod Affinity/AntiAffinity、Taints & Tolerations、资源 requests/limits

### Q15：Pod 生命周期状态？

**答案：**
Pending、ContainerCreating、Running、Succeeded、Failed、Unknown，通过 `kubectl describe pod` 查看事件

---

## 三、K8s 网络与服务

### Q16：Pod 间通信原理？

**答案：**
每个 Pod 有唯一 IP，可直接通信；Service 通过 kube-proxy 或 iptables/IPVS 做负载均衡；CNI 管理网络。

### Q17：常见 CNI 插件及区别？

| 插件      | 特点            | 场景     |
| ------- | ------------- | ------ |
| Flannel | 简单 overlay    | 小集群    |
| Calico  | 支持网络策略、性能好    | 企业生产   |
| Cilium  | eBPF 高性能网络、安全 | 大规模微服务 |

### Q18：Ingress 与 Service 区别？

**答案：**
Service：内部/外部负载均衡
Ingress：HTTP/HTTPS 路由，TLS，虚拟主机，需要 Ingress Controller

### Q19：NetworkPolicy 是什么？

**答案：**
控制 Pod 间流量，基于命名空间、标签和端口，可实现微分段和安全隔离。

### Q20：Service Mesh 作用？

**答案：**
管理微服务通信，提供流量控制、熔断、灰度发布、服务观察性。常用 Istio、Linkerd、Consul。

### Q21：K8s DNS 原理？

**答案：**
CoreDNS 提供服务名解析，Pod 通过 DNS 查找 Service，Service IP 映射到 Endpoint，实现负载均衡。

### Q22：Pod 与外部通信方式？

**答案：**
NodePort/LoadBalancer Service、Ingress、Egress gateway/NAT。

---

## 四、存储与数据管理

### Q23：K8s 常用卷类型及区别？

| 类型               | 特点      | 场景     |
| ---------------- | ------- | ------ |
| emptyDir         | 临时存储    | 缓存     |
| hostPath         | 节点目录    | 本地文件访问 |
| PVC + PV         | 持久化存储   | 数据库、日志 |
| ConfigMap/Secret | 配置或敏感信息 | 配置管理   |

### Q24：Pod 重启数据丢失原因及解决？

**答案：**
emptyDir 随 Pod 删除丢失，使用 PVC 持久卷，配合 StatefulSet 保留数据。

### Q25：StorageClass 有什么作用？

**答案：**
定义动态存储策略，指定类型和参数，动态创建 PV，支持云存储卷。

---
好的，我们按批次继续生成。我将一次性规划 **第 2 批到第 5 批**，覆盖剩余内容，确保累计达到 100+ 面试题。每批约 25 个题目。

---

# Kubernetes 面试题（第 2 批 26-50题）

---

## 五、监控与故障排查

### Q26：Pod Pending / CrashLoopBackOff 排查方法？

**答案：**

* Pending：资源不足、节点污点、亲和性不满足
* CrashLoopBackOff：容器启动失败，检查镜像、命令、配置

### Q27：节点 NotReady 排查方法？

**答案：**

1. `kubectl describe node` 查看状态
2. 查看 kubelet 日志
3. 检查网络插件、资源
4. 重启 kubelet 或节点

### Q28：常用排查命令？

**答案：**

* `kubectl get pods -o wide`
* `kubectl describe pod <pod>`
* `kubectl logs <pod>`
* `kubectl exec -it <pod> -- bash`
* `kubectl get events`
* `kubectl top pod/node`

### Q29：监控工具？

**答案：**

* Prometheus + Grafana（指标监控）
* EFK / Loki + Grafana（日志收集）
* metrics-server（轻量级指标采集）

### Q30：事件与日志分析流程？

**答案：**

* 查看事件：`kubectl get events`
* Pod logs 分析
* kubelet logs 排查节点问题
* 使用监控告警追踪异常指标

### Q31：readinessProbe 和 livenessProbe 的区别？

**答案：**

* readinessProbe：检查 Pod 是否可以接收流量
* livenessProbe：检查 Pod 是否存活，失败则重启容器

### Q32：Pod 无法调度的原因？

**答案：**

* 资源不足（CPU/内存）
* 节点污点未容忍
* 调度约束未满足（NodeSelector、Affinity）

### Q33：调度器如何选择节点？

**答案：**
考虑节点资源、污点/容忍、亲和性、拓扑分布策略和优先级策略

### Q34：Pod 被驱逐的原因？

**答案：**

* 节点资源不足（内存、磁盘）
* 节点不可用
* Pod 优先级低于其他 Pod

### Q35：水平 Pod 自动扩缩容 HPA 限制？

**答案：**

* 依赖 Metrics Server
* 只能水平扩缩容 Pod 数量
* 对短期突发流量不敏感

### Q36：垂直 Pod 自动扩缩容 VPA 限制？

**答案：**

* 改变 CPU/内存请求
* 对有状态 Pod 更新需重启
* 与 HPA 配合需小心冲突

### Q37：滚动更新中 maxUnavailable/maxSurge 参数作用？

**答案：**

* maxUnavailable：允许不可用 Pod 数量
* maxSurge：允许超过期望副本的 Pod 数量

### Q38：节点自动扩容（Cluster Autoscaler）原理？

**答案：**

* 根据 Pending Pod 检测资源不足
* 自动添加节点
* 根据空闲节点删除多余节点

### Q39：Pod 调度失败时使用 taints & tolerations？

**答案：**

* taints：标记节点不可调度
* tolerations：Pod 才能调度到带 taint 的节点

### Q40：日志收集最佳实践？

**答案：**

* 集中化收集（EFK/Loki）
* 按应用/命名空间分组
* 日志持久化与轮换

### Q41：监控指标常用有哪些？

**答案：**

* Pod/Node CPU、内存
* Pod 重启次数
* 网络流量
* 应用自定义指标（QPS、延迟）

### Q42：Prometheus + Grafana 工作原理？

**答案：**

* Prometheus 抓取指标数据
* Grafana 可视化展示
* Alertmanager 发送告警

### Q43：如何监控 StatefulSet 应用？

**答案：**

* 采集 Pod 资源指标
* 采集应用日志和性能指标
* 关注序号顺序和 PVC 使用情况

### Q44：Pod 事件如何查看？

**答案：**
`kubectl describe pod <pod>` 查看 Events

### Q45：常见故障处理流程？

**答案：**

* 检查 Pod 状态
* 查看事件和日志
* 检查节点资源和调度
* 重启或替换 Pod
* 监控与告警联动

### Q46：CrashLoopBackOff 典型原因？

**答案：**

* 镜像拉取失败
* 启动命令错误
* 依赖服务未就绪
* 资源不足导致容器频繁重启

### Q47：K8s 集群健康检查方法？

**答案：**

* API Server 状态检查
* 节点 Ready 状态
* Pod 就绪率和重启次数
* etcd 健康检查

### Q48：Pod 删除策略有哪些？

**答案：**

* Foreground：先删除子资源再删除 Pod
* Background：后台删除
* Orphan：保留子资源

### Q49：Deployment 回滚操作？

**答案：**
`kubectl rollout undo deployment <name>`
查看历史：`kubectl rollout history deployment <name>`

### Q50：调度优先级和抢占机制？

**答案：**

* Pod 可以设置 priorityClass
* 高优先级 Pod 可抢占低优先级 Pod 的资源

---

好的，继续生成 **第 3 批 51-75题**，涵盖安全、RBAC、CI/CD、日志、运维和升级相关内容。

---

# Kubernetes 面试题（第 3 批 51-75题）

---

## 六、安全与访问控制

### Q51：RBAC 权限模型？

**答案：**

* Role：命名空间级权限
* ClusterRole：集群级权限
* RoleBinding / ClusterRoleBinding：绑定用户或 ServiceAccount

### Q52：Secret 和 ConfigMap 区别？

**答案：**

* ConfigMap：非敏感配置信息
* Secret：敏感信息（密码、证书），base64 编码，可挂载或注入环境变量

### Q53：ServiceAccount 作用？

**答案：**

* Pod 使用 ServiceAccount 访问 API Server
* 可绑定 Role/ClusterRole 控制权限

### Q54：Pod 安全上下文 SecurityContext？

**答案：**

* 指定运行用户 UID/GID
* 权限控制（readOnlyRootFilesystem, allowPrivilegeEscalation）
* 能限制容器权限

### Q55：Pod 安全策略 PodSecurityPolicy (PSP)？

**答案：**

* 定义 Pod 安全要求（用户、特权、卷类型）
* 限制容器能力
* Kubernetes 1.25 已废弃，使用 OPA/Gatekeeper 替代

### Q56：NetworkPolicy 如何限制流量？

**答案：**

* 定义允许/拒绝 ingress/egress
* 通过命名空间、标签、端口匹配
* 只允许符合规则的 Pod 通信

### Q57：常见 K8s 安全最佳实践？

**答案：**

* 限制容器权限
* 使用 Role/ClusterRole 管理权限
* 使用 Secret 管理敏感信息
* 启用 NetworkPolicy
* 镜像扫描与漏洞检测

### Q58：如何限制 Pod 访问 API Server？

**答案：**

* ServiceAccount 绑定最小权限 Role/ClusterRole
* NetworkPolicy 阻止不必要 Pod 访问

### Q59：镜像安全管理？

**答案：**

* 使用可信 registry
* 定期扫描镜像漏洞
* 禁止使用最新标签 `:latest`
* 镜像签名与校验

### Q60：K8s 审计日志作用？

**答案：**

* 记录 API 调用历史
* 追踪用户、操作、资源变化
* 安全事件排查

---

## 七、CI/CD 与云原生集成

### Q61：CI/CD 与 K8s 集成思路？

**答案：**

1. Git 提交触发流水线
2. 构建镜像并 push registry
3. Helm/ArgoCD/Flux 部署到 K8s
4. 配置蓝绿/灰度发布
5. 监控与回滚

### Q62：Helm 作用？

**答案：**

* K8s 应用包管理工具
* 支持模板化部署、多环境部署
* 管理 Release 版本

### Q63：ArgoCD 作用？

**答案：**

* GitOps 自动化部署
* 同步 Git 仓库与 K8s 集群
* 支持多集群管理

### Q64：Flux 作用？

**答案：**

* GitOps 工具
* 自动同步 K8s 配置
* 支持 Helm 和 Kustomize

### Q65：Kustomize 作用？

**答案：**

* 原生 K8s 配置定制化工具
* Overlay 管理不同环境配置
* 不需要模板化语言

### Q66：蓝绿/灰度发布在 CI/CD 流程中如何实现？

**答案：**

* 蓝绿发布：同时部署旧版本和新版本，通过 Service 切换流量
* 灰度发布：部分流量导向新版本，通过 Ingress 或 Service Mesh 控制

### Q67：如何在 CI/CD 中实现回滚？

**答案：**

* Deployment：`kubectl rollout undo deployment <name>`
* Helm：`helm rollback <release> <revision>`

### Q68：CI/CD 流水线常见步骤？

**答案：**

1. 代码检查与单元测试
2. 镜像构建与扫描
3. 镜像推送 registry
4. 部署到 K8s
5. 测试与回滚策略

### Q69：ConfigMap/Secret 如何在 CI/CD 中管理？

**答案：**

* 作为配置模板或敏感变量
* 环境变量注入到 Pod
* 配置变更触发 Deployment 滚动更新

### Q70：K8s 与微服务结合的优势？

**答案：**

* 弹性伸缩
* 服务发现和负载均衡
* 灰度发布和流量控制
* 自动运维与健康管理

---

## 八、日志与运维

### Q71：日志收集常用架构？

**答案：**

* DaemonSet 部署 Fluentd/Fluent Bit/Logstash
* 日志写入集中存储（Elasticsearch、Loki）
* Grafana 可视化

### Q72：Pod 内日志管理方法？

**答案：**

* 容器 stdout/stderr 输出
* 挂载卷保存日志
* 集中收集和聚合

### Q73：监控与告警结合方法？

**答案：**

* Prometheus 抓取指标
* Alertmanager 发送告警
* Grafana Dashboard 可视化

### Q74：K8s 节点维护流程？

**答案：**

1. cordon 节点（禁止调度新 Pod）
2. drain 节点（迁移 Pod）
3. 维护或升级节点
4. uncordon 节点

### Q75：Pod 优雅终止过程？

**答案：**

* 发送 SIGTERM
* 触发 preStop hook
* 等待 terminationGracePeriodSeconds
* 删除 Pod

---

好的，继续生成 **第 4 批 76-100+题**，覆盖高级网络、存储、Service Mesh、Operator、CRD、高可用、多集群管理等内容，完成 100+ 面试题。

---

# Kubernetes 面试题（第 4 批 76-100+题）

---

## 九、高级网络与服务

### Q76：Pod 网络通信模型？

**答案：**

* 每个 Pod 拥有唯一 IP
* Pod 间可直接通信
* Service 通过 kube-proxy/IPVS 负载均衡
* CNI 插件实现 Overlay 或 L2/L3 网络

### Q77：IPVS 与 iptables 区别？

**答案：**

* iptables：链表匹配，性能一般
* IPVS：基于内核虚拟服务器，高性能、支持更多调度算法

### Q78：CNI 插件选择原则？

**答案：**

* 集群规模、性能需求
* 网络策略支持
* 容器互通与安全隔离

### Q79：Ingress Controller 与 Service 的关系？

**答案：**

* Ingress Controller 实现 Ingress 资源功能
* 将 HTTP/HTTPS 请求路由到对应 Service
* 支持 TLS、虚拟主机、负载均衡

### Q80：Service Mesh 核心组件？

**答案：**

* 数据平面：Sidecar 代理（Envoy）
* 控制平面：配置、流量管理（Istio Pilot）
* 支持流量控制、可观察性、安全

---

## 十、存储高级应用

### Q81：StatefulSet 使用 PVC 原因？

**答案：**

* 每个 Pod 独立卷
* Pod 重建后数据不丢失
* 支持顺序启动和更新

### Q82：动态卷申请流程？

**答案：**

1. 创建 PVC
2. 根据 StorageClass 调用 Provisioner 创建 PV
3. PVC 与 PV 绑定，挂载到 Pod

### Q83：卷回收策略？

**答案：**

* Retain：保留 PV 数据
* Delete：删除 PV 和数据
* Recycle：废弃（不推荐）

### Q84：卷共享访问方式？

**答案：**

* ReadWriteOnce (RWO)
* ReadOnlyMany (ROX)
* ReadWriteMany (RWX)

### Q85：CSI 插件作用？

**答案：**

* 容器存储接口
* 支持第三方存储动态挂载
* 可扩展和标准化存储操作

---

## 十一、高可用与集群管理

### Q86：K8s 高可用 Master 实现？

**答案：**

* 多 Master 节点
* etcd 多副本
* 外部 VIP 或 LoadBalancer 对外访问

### Q87：Node 高可用策略？

**答案：**

* 多节点冗余
* Pod 分布式部署
* 自动扩容和自动恢复

### Q88：多集群管理方式？

**答案：**

* KubeFed 联邦集群
* Rancher、ArgoCD multi-cluster
* 跨集群服务发现与同步

### Q89：etcd 集群高可用方案？

**答案：**

* 奇数节点多副本
* Leader 选举机制
* 定期备份与监控

### Q90：集群升级步骤？

**答案：**

1. Master 节点升级
2. Node 节点升级
3. 升级 kube-proxy、CNI
4. 回滚策略与验证

---

## 十二、CRD、Operator 与扩展

### Q91：什么是 CRD？

**答案：**

* CustomResourceDefinition
* 扩展 K8s API，定义自定义资源
* 支持 Operator 管理自定义对象

### Q92：Operator 原理？

**答案：**

* 使用控制循环管理应用生命周期
* 监听 CRD 事件，自动创建/更新/删除资源
* 支持有状态应用自动化运维

### Q93：CRD 与 Operator 的关系？

**答案：**

* CRD 定义自定义资源
* Operator 通过控制循环管理 CRD 实例

### Q94：如何开发简单 Operator？

**答案：**

1. 定义 CRD
2. 编写 Controller（Go、Kubebuilder）
3. 处理资源事件
4. 自动化部署与升级

### Q95：常见 Operator 使用场景？

**答案：**

* 数据库（MySQL、Postgres）
* Kafka、Redis 集群
* 应用自定义扩展

---

## 十三、服务与应用发布

### Q96：蓝绿发布与灰度发布区别？

**答案：**

* 蓝绿：旧版本和新版本并存，Service 切流量
* 灰度：部分流量导向新版本，逐步放量

### Q97：滚动更新与重建更新区别？

**答案：**

* 滚动更新：逐步替换 Pod，零停机
* Recreate：先删除所有旧 Pod，再创建新 Pod

### Q98：readinessProbe 在发布中作用？

**答案：**

* 确保 Pod 准备就绪才接流量
* 避免流量切到未准备好 Pod

### Q99：Pod 调度策略优化？

**答案：**

* 优先级与抢占
* Node Affinity / Pod Affinity
* Taints & Tolerations
* Topology Spread Constraints

### Q100：容器镜像拉取策略？

**答案：**

* Always：总拉最新镜像
* IfNotPresent：已存在则不拉
* Never：只使用本地镜像

### Q101：资源限制及 QoS？

**答案：**

* Requests：保证资源
* Limits：上限资源
* QoS：Guaranteed / Burstable / BestEffort

### Q102：K8s 日志轮转与持久化？

**答案：**

* 容器 stdout/stderr 输出
* 配合 logrotate 或 Fluentd 集中收集
* 存储到持久卷或外部系统

### Q103：Pod 安全上下文最佳实践？

**答案：**

* 限制 root 权限
* 使用 readOnlyRootFilesystem
* 设置 runAsUser/runAsGroup

---





